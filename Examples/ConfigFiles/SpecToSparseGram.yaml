processor-toolbox:

    processors:
        - { type: "spec-processor",                  name: "spec1" }
        - { type: "data-accumulator",                name: "acc" }
        - { type: "gain-variation",                  name: "gainvar" }
        - { type: "spec-processor",                  name: "spec2" }
        - { type: "variable-spectrum-discriminator", name: "discrim" }
        - { type: "basic-root-writer",               name: "brw" }
        - { type: "root-spectrogram-writer",         name: "rsw"}
        - { type: "root-tree-writer",                name: "rtw"}
   
    connections:
            - signal: "spec1:ps"         # spec file power spectra to accumulator
              slot: "acc:ps"

            - signal: "acc:ps-finished"  # accumulated power spectra to gain variation
              slot: "gainvar:ps-var"

            - signal: "acc:ps-finished"  # accumulated power spectra to ROOT file
              slot: "brw:ps"
 
            - signal: "gainvar:gain-var" # write gain-var histogram to ROOT file
              slot: "brw:gain-var"

            - signal: "gainvar:gain-var"
              slot: "discrim:gv"

            - signal: "spec2:ps"
              slot: "rsw:ps"

            - signal: "spec2:ps"
              slot: "discrim:ps-pre"
 
            - signal: "discrim:disc-1d"
              slot: "rtw:disc-1d"

            - signal: "spec2:spec-done"
              slot: "rsw:write-file"
 
    run-queue:
        - spec1
        - spec2

    
spec1:
    filename: "../He6_Data/Fake_bootstrap_2020-04-10-15-29-48_000000.spec"
    spectra: 1600
    freq-bins: 8192
    min-freq: 0.0
    max-freq: 1.6e9
    header-bytes: 32


acc:
    number-to-average: 0
    signal-interval: 0

gainvar:
    normalize: false
    min-frequency: 2e6
    max-frequency: 1598e6
    fit-points: 50


spec2:
    filename: "../He6_Data/Fake_bootstrap_2020-04-10-15-29-48_000001.spec"
    spectra: 1600
    freq-bins: 8192
    min-freq: 0.0
    max-freq: 1.6e9
    header-bytes: 32

discrim:
    min-frequency: 8e6
    max-frequency: 1592e6
    snr-threshold-power: 2.0


brw:
    output-file: "../He6_Data/Bootstrap_accum.root"
    file-flag: "recreate"

rsw:
    output-file: "../He6_Data/Spectrogram.root"
    file-flag: recreate
    mode: sequential
    n-time-bins: 1588
    min-freq: 5.0e6
    max-freq: 1595.0e6

rtw:
    output-file: "../He6_Data/TracksAndEvents.root"
    file-flag: recreate


